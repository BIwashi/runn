desc: Test using SQLite3
steps:
  -
    db:
      query: |
        CREATE TABLE users (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          username TEXT UNIQUE NOT NULL,
          password TEXT NOT NULL,
          email TEXT UNIQUE NOT NULL,
          created NUMERIC NOT NULL,
          updated NUMERIC
        )
  -
    db:
      query: INSERT INTO users (username, password, email, created) VALUES ('alice', 'passw0rd', 'alice@example.com', datetime('2017-12-05'))
  -
    db:
      query: SELECT * FROM users;
  -
    test: 'steps[2].rows[0].username == "alice"'
  -
    db:
      query: INSERT INTO users (username, password, email, created) VALUES ('bob', 'passw0rd', 'bob@example.com', datetime('2022-02-22'))
  -
    db:
      query: SELECT * FROM users WHERE id = {{ steps[4].last_insert_id }}
  -
    test: 'steps[5].rows[0].username == "bob"'
  -
    db:
      query: SELECT COUNT(*) AS c FROM users
  -
    test: 'steps[7].rows[0].c == 2'
