-- -testdata-book-http.yml --
desc: Captured of http.yml run
runners:
  req: '[THIS IS HTTP RUNNER]'
steps:
- req:
    /users:
      post:
        body:
          application/json:
            password: passw0rd
            username: alice
  test: |
    current.res.status == 201
    && current.res.headers['Content-Length'][0] == "0"
    && 'Date' in current.res.headers
    && current.res.rawBody == ""
- req:
    /help:
      post:
        body:
          application/x-www-form-urlencoded:
            content: help me
            name: bob
  test: |
    current.res.status == 201
    && current.res.headers['Content-Length'][0] == "0"
    && 'Date' in current.res.headers
    && current.res.rawBody == ""
- req:
    /upload:
      post:
        body:
          multipart/form-data; boundary=123456789012345678901234567890abcdefghijklmnopqrstuvwxyz: !!binary |
            LS0xMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTBhYmNkZWZnaGlqa2xtbm9wcXJzdH
            V2d3h5eg0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJmaWxlMSI7
            IGZpbGVuYW1lPSJkdW1teS5wbmciDQpDb250ZW50LVR5cGU6IGltYWdlL3BuZw0KDQqJUE
            5HDQoaCgAAAA1JSERSAAAAPAAAACgEAwAAAFCVhMwAAAAYUExURQAAAP///19fXx8fHz8/
            P39/f5ubm5+fn73xLkMAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABhSURBVDiNY2AYBaMAEz
            ApMSmBGSwKUAYKMGFQZnZgZmBmYFIAMjCkVZQUGBSYFQIYFBSADAzpAIYEoKg5A4sBVmkF
            hgSgmSpAi4sVsBjO6mqqysDCYAxUyKpKordGwQgBAPAcB/Md2LK9AAAAAElFTkSuQmCCDQ
            otLTEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN0
            dXZ3eHl6DQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUyIj
            sgZmlsZW5hbWU9ImR1bW15LmpwZWciDQpDb250ZW50LVR5cGU6IGltYWdlL2pwZWcNCg0K
            /9j/4AAQSkZJRgABAQEAYABgAAD//gA+Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZy
            BJSkcgSlBFRyB2ODApLCBkZWZhdWx0IHF1YWxpdHkK/9sAQwAIBgYHBgUIBwcHCQkICgwU
            DQwLCwwZEhMPFB0aHx4dGhwcICQuJyAiLCMcHCg3KSwwMTQ0NB8nOT04MjwuMzQy/9sAQw
            EJCQkMCwwYDQ0YMiEcITIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIy
            MjIyMjIyMjIyMjIy/8AAEQgAKAA8AwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAA
            ABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQy
            gZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWV
            pjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrC
            w8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQ
            EAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEH
            YXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSl
            NUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKz
            tLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQ
            MRAD8A+f6KKKACiiigAooooAKKKKACiiigDp5UtWgf7ELASJKiQGeSAh4cHLEEDB/1ed2W
            5bGMNWWkOmyG8YyFArsbVS2PMHOA3HHY579O+5cyigDes005dOQedaST+YrASAht5R8Akg
            DYGCZ5x1J4PGbqQUTRf6nzvLHneTt2bsnGNvy/d25x3zVOigAooooAKKKKACiiigAooooA
            KKKKAP/ZDQotLTEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG
            1ub3BxcnN0dXZ3eHl6LS0NCg==
  test: |
    current.res.status == 201
    && current.res.headers['Content-Length'][0] == "0"
    && 'Date' in current.res.headers
    && current.res.rawBody == ""
- req:
    /notfound:
      get:
        body:
          application/json: nil
  test: |
    current.res.status == 404
    && current.res.headers['Content-Length'][0] == "18"
    && current.res.headers['Content-Type'][0] == "text/html; charset=utf-8"
    && 'Date' in current.res.headers
    && current.res.rawBody == "<h1>Not Found</h1>"
- req:
    /users/1:
      get:
        body:
          application/json: null
  test: |
    current.res.status == 200
    && current.res.headers['Content-Length'][0] == "29"
    && current.res.headers['Content-Type'][0] == "application/json"
    && 'Date' in current.res.headers
    && compare(current.res.body, {"data":{"username":"alice"}})
- req:
    /private?token=xxxxx:
      get:
        body:
          application/json: null
  test: |
    current.res.status == 403
    && current.res.headers['Content-Length'][0] == "21"
    && current.res.headers['Content-Type'][0] == "application/json"
    && 'Date' in current.res.headers
    && compare(current.res.body, {"error":"Forbidden"})
- req:
    /private:
      get:
        headers:
          Authorization: Bearer xxxxx
        body:
          application/json: null
  test: |
    current.res.status == 200
    && current.res.headers['Content-Length'][0] == "0"
    && 'Date' in current.res.headers
    && current.res.rawBody == ""
- req:
    /redirect:
      get:
        body:
          application/json: null
  test: |
    current.res.status == 404
    && current.res.headers['Content-Length'][0] == "18"
    && current.res.headers['Content-Type'][0] == "text/html; charset=utf-8"
    && 'Date' in current.res.headers
    && current.res.rawBody == "<h1>Not Found</h1>"
